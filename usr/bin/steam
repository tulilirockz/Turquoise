#!/bin/sh
# distrobox_binary
# name: gamebox
if [ ! -f /run/.containerenv ] && [ ! -f /.dockerenv ]; then
	if ! podman container exists gamebox ; then
		set -euo pipefail
		distrobox create -i ghcr.io/tulilirockz/gamebox gamebox
		set +euo pipefail
	fi

	command="/usr/bin/distrobox-enter  -n gamebox --  /usr/bin/steam  "

	for arg in "$@"; do
		if echo "${arg}" | grep -Eq "'|\""; then
			command="${command} \
				$(echo "${arg}" | sed 's|\\|\\\\|g' |
				sed 's| |\\ |g' |
				sed 's|\$|\\\$|g' |
				sed "s|'|\\\'|g" |
				sed 's|"|\\\"|g')"
		elif echo "${arg}" | grep -q "'"; then
			command="${command} \"${arg}\""
		else
			command="${command} '${arg}'"
		fi
	done
	eval ${command}
else
	/usr/bin/steam "$@"
fi
